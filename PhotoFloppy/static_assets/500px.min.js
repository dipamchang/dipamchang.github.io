!function(){"use strict";var t,i;i=function(){function i(t,i){return encodeURIComponent(i?i+"["+t+"]":t)}function n(t,n){var o,e,s=[];for(o in t)if(t.hasOwnProperty(o)){var a=t[o];if(a instanceof Array)for(e=0;e<a.length;e++){var r=encodeURIComponent(a[e]);s.push(i(o,n)+"%5B%5D="+r)}else s.push("object"==typeof a?this.object_to_params(a,i(o,n)):i(o,n)+"="+encodeURIComponent(a))}return s.join("&")}var o,e,s,a,r,u,d,h,c,i,n,l,f,p=this,_="https://api.500px.com/",k="v1",y=_+k,g={};for(this.init=function(t){if(this.sdk_key)throw"init: Already initialized";if(!t||!t.sdk_key)throw"init: You must specify an sdk key";if(!document.body)throw"init: Could not find the body element, make sure the document is loaded before calling init";this.sdk_key=t.sdk_key,t&&t.oauth_token&&(o=t.oauth_token);var i,n=document.createElement("div");n.id="_500px_container",n.style.display="none",n.style.width=0,n.style.height=0,n.style.border=0,n.style.margin=0,n.style.padding=0,document.body.appendChild(n),e=document.getElementById("_500px_container"),i=function(){var t=document.getElementById("_500px_container");return document.body.removeChild(t),null}},this.api=function(){if(!this.sdk_key)throw"api: SDK not initialized. Use _500px.init() first.";var t,i,e,s,a,r,u,d;if(t=Array.prototype.slice.call(arguments),i=t.shift(),!i||""==i.replace(/^\s*/,"").replace(/\s*$/,""))throw"api: You must specify an end point";e="get",t[0]&&"string"==typeof t[0]&&(e=t.shift()),s={},t[0]&&"object"==typeof t[0]&&(s=t.shift()),a=function(){},t[0]&&"function"==typeof t[0]&&(a=t.shift()),s._method=e,o&&(s.oauth_token=o),s.sdk_key=this.sdk_key,r=document.createElement("script"),u=h(),window[u]=function(t){document.body.removeChild(r),c(a)(t)},d=y+i+".jsonp",s.callback=u,d+="?",d+=n(s),r.src=d,document.body.appendChild(r)},this.login=function(t){if(!this.sdk_key)throw"login: SDK not initialized. Use _500px.init() first.";var i,n,o;i=h(),window[i]=function(i){f.call(p,t,i)},n=screen.width/2-620,o=screen.height/2-240,window.open(_+"api/js-sdk/authorize?sdk_key="+this.sdk_key+"&callback="+i,"500px_js_sdk_login","width=1240,height=480,left="+n+",top="+o+",menu=no,location=yes,scrollbars=no,status=no,toolbar=no")},this.authorize=function(t){if(!this.sdk_key)throw"authorize: SDK not initialized. Use _500px.init() first.";this.login(t)},this.ensureAuthorization=function(t){if(!this.sdk_key)throw"ensureAuthorization: SDK not initialized. Use _500px.init() first.";var i=function(){t&&t.call(p)};return o?void i():void this.getAuthorizationStatus(function(t){"authorized"==t?i():p.login(function(t){"authorized"==t&&i()})})},this.getAuthorizationStatus=function(t){if(!this.sdk_key)throw"getAuthorizationStatus: SDK not initialized. Use _500px.init() first.";var i=h(),n=document.createElement("iframe");window[i]=function(i){setTimeout(function(){e.removeChild(n)},0),i.not_logged_in?(o=null,t&&"function"==typeof t&&t("not_logged_in")):i.not_authorized?(o=null,t&&"function"==typeof t&&t("not_authorized")):i.token&&(o=i.token,l("authorization_obtained"),t&&"function"==typeof t&&t("authorized"))},n.src=_+"api/js-sdk/check_authorization?sdk_key="+this.sdk_key+"&callback="+i,e.appendChild(n)},this.on=function(t,i){if(g[t]||(g[t]=[]),"function"!=typeof i)throw"on: Callback is not a function";g[t].push(i)},this.off=function(t,i){var n,o;if(i){if(!g[t])return;for(n=0;n<g[t].length;n++)o=g[t][n],o==i&&(g[t][n]=void 0)}else g[t]=[]},this.logout=function(t){if(!this.sdk_key)throw"logout: SDK not initialized. Use _500px.init() first.";if(!o)throw"logout: User is not logged in";var i,n,s=h(),a=document.createElement("iframe");window[s]=function(i){var n;setTimeout(function(){e.removeChild(a)},0),i.no_token_specified?n="no_token_specified":i.invalid_token?n="invalid_token":i.not_logged_in?n="not_logged_in":i.logged_out&&(n="logged_out"),t&&"function"==typeof t&&t(n),l("logout")},navigator.userAgent.match(/MSIE/)?(i=screen.width/2-620,n=screen.height/2-240,window.open(_+"api/js-sdk/authorize?sdk_key="+this.sdk_key+"&token="+o+"&_method=delete&callback="+s,"500px_logout_window","width=1240,height=480,left="+i+",top="+n+",menu=no,location=yes,scrollbars=no,status=yes,toolbar=yes")):a.src=_+"api/js-sdk/authorize?sdk_key="+this.sdk_key+"&token="+o+"&_method=delete&callback="+s,e.appendChild(a)},l=function(t){if(g[t]){var i;for(i=0;i<g[t].length;i++)g[t][i].call(p)}},f=function(t,i){i.denied&&t&&"function"==typeof t?(l("authorization_cancelled"),t.call(p,"denied")):i.token&&(o=i.token,l("authorization_obtained"),t&&"function"==typeof t&&t.call(p,"authorized"))},c=function(i){return function(n){var e=new t(n);i.call(p,e),n.status&&401==n.status&&(o=null,l("logout"))}},h=function(){return"_500pxCallback"+String(Math.round(1e8*Math.random()))},s=["init","api","login","authorize","ensureAuthorization","getAuthorizationStatus","on","off","logout"],a=function(t){return function(){t.apply(p,arguments)}},r=0;r<s.length;r++)u=s[r],d=this[u],this[u]=a(d)},window._500px=new i,t=function(t){this.success=!0,t.status&&200!=t.status&&t.error&&(this.success=!1,this.error_message=t.error,this.status=t.status),this.status||(this.status=200),this.error=!this.success,this.data=t}}();